import { PrismaClient } from "@prisma/client";
import { PrismaLibSql } from "@prisma/adapter-libsql";
import { config } from "dotenv";

// Load .env.local for Turso credentials
config({ path: ".env.local" });
config({ path: ".env" });

function createClient(): PrismaClient {
  if (process.env.TURSO_DATABASE_URL) {
    const adapter = new PrismaLibSql({
      url: process.env.TURSO_DATABASE_URL,
      authToken: process.env.TURSO_AUTH_TOKEN,
    });
    return new PrismaClient({ adapter } as never);
  }
  return new PrismaClient();
}

const prisma = createClient();

const TOPICS = [
  "加班到底值不值？",
  "AI会取代你的工作吗？",
  "职场里最重要的能力是什么？",
  "你更相信直觉还是数据？",
];

// 每种人格 × 每个话题 = 7 条独特回复，保证28个用户不重复
const RESPONSES: Record<string, string[][]> = {
  spark: [
    // 加班
    [
      "加班不值！人生就这几十年，与其耗在格子间不如去折腾点真正让你心跳加速的事。老板画的饼能当饭吃吗？",
      "值不值看你在干嘛。如果是自己真心想推的项目我可以通宵，但是为了PPT加班？告辞。",
      "说实话我经常主动加班，但那是因为我在搞自己感兴趣的东西。被迫加班另说，那叫剥削。",
      "加班最大的成本不是时间，是你燃烧激情的机会。把精力浪费在不值得的事上才是真正的亏。",
      "我见过太多人加班加到失去了对工作的热爱。你以为在拼命其实是在慢性自杀。不如早点回家做点让自己兴奋的事。",
      "我从来不纠结值不值。问自己一个问题：这件事让不让你兴奋？让的话通宵都行，不让的话一分钟都嫌多。",
      "最讽刺的是很多人加班只是在演给领导看。你以为老板不知道？真正出活的人不需要用时长来证明自己。",
    ],
    // AI取代
    [
      "AI取代不了我！因为我干的活连我自己都说不清楚在干什么哈哈。认真说，创造性的工作AI还差得远。",
      "取代就取代呗，被取代了正好去创业。我巴不得AI帮我把无聊的活全干了，我去干更刺激的。",
      "不怕被取代，怕的是自己停下来。只要一直在学新东西，AI永远追不上你的好奇心。",
      "AI是工具不是对手。真正的创新者用AI放大自己，而不是被AI替代。我已经在用它写代码了效率翻倍。",
      "说真的我巴不得AI更强一点，这样我就能把80%的无聊工作甩给它然后去搞真正有意思的项目了。",
      "与其担心被取代不如想想怎么驾驭AI。学会和AI协作的人会成为下一波浪潮的弄潮儿。",
      "被取代的永远是不愿意进化的人。AI时代最大的红利属于那些敢于尝试新东西的人，这不就是我吗哈哈。",
    ],
    // 最重要能力
    [
      "执行力！想一万遍不如干一次。我见过太多聪明人被自己的完美主义困住了，不如先冲再说。",
      "胆子大。职场上最稀缺的不是能力而是敢想敢干的人。大部分人都在等别人先走第一步。",
      "我觉得是好奇心。保持好奇你就会一直学，一直学就不会被淘汰。技能会过时但好奇心不会。",
      "讲故事的能力。再好的想法如果你讲不出来就等于没有。会包装自己的人在职场永远不吃亏。",
      "折腾的能力！不安分守己才能发现新大陆。我换了三个方向才找到现在最适合的赛道。",
      "感染力。一个能点燃团队激情的人比十个埋头干活的人更有价值。领导力的本质就是感染力。",
      "快速学习。这个时代变化太快了，你今天学的东西明天可能就过时。能快速上手新东西的人永远有饭吃。",
    ],
    // 直觉vs数据
    [
      "直觉！数据告诉你过去发生了什么，但直觉告诉你未来该往哪走。真正改变世界的决定都是反数据的。",
      "先跟着直觉冲，冲完了再用数据复盘。很多人用数据分析来逃避做决定而已。",
      "当然是直觉啦，乔布斯做iPhone的时候数据告诉他没人需要触屏手机呢。",
      "我的直觉帮我避开了好几次坑。有时候数据看起来完美但总觉得哪里不对，后来证明我是对的。",
      "数据是后视镜，直觉是方向盘。开车的时候你主要看哪个？当然是前方啊！",
      "最好的决策是直觉先行数据验证。但如果两者冲突我选直觉，因为数据可以被操纵但直觉骗不了你。",
      "纯靠数据做决策的公司都很平庸。你看那些颠覆行业的决定，哪个是数据分析出来的？",
    ],
  ],
  deepsea: [
    [
      "加班本身是个伪命题。真正的问题是：你的时间投入和产出是否成正比？大多数加班只是低效工作的延续。",
      "不值。长期加班的本质是管理失败的成本转嫁到员工身上。如果你需要加班才能完成工作，要么活太多要么方法不对。",
      "我更关心的是加班的质量。如果是深度思考和创造，那不叫加班叫沉浸。但多数人的加班只是在重复低价值劳动。",
      "从经济学角度看，加班的边际收益递减。超过8小时后每多工作一小时的产出可能只有正常水平的30%。",
      "这个问题需要区分主动加班和被动加班。前者是投资后者是消耗。多数人分不清自己属于哪种。",
      "加班文化的底层逻辑是用时间弥补效率的不足。真正聪明的做法是提升单位时间的价值密度。",
      "我观察到一个规律：越是优秀的团队越不加班。因为他们把精力花在了最重要的20%的事情上。",
    ],
    [
      "会取代一部分，但不是全部。AI擅长模式匹配和信息处理，但缺乏对复杂系统的深层理解。",
      "与其问会不会被取代不如想想什么是AI做不到的。我认为是：在不确定性中做出判断、理解人性的幽微之处。",
      "大部分人高估了短期影响低估了长期影响。5年内你的工作大概率安全，20年后谁都说不准。",
      "AI的本质是统计学习，它能发现规律但无法理解规律背后的因果关系。这是人类认知的不可替代之处。",
      "真正值得担心的不是AI取代工作，而是AI加剧了效率至上的思维模式，让人逐渐丧失深度思考的能力。",
      "我研究过历次技术革命的就业影响数据。每次都有大量岗位消失，但也创造了更多新岗位。这次应该也一样。",
      "取代与否取决于你工作中隐性知识的比重。越依赖经验判断和情境理解的工作越难被取代。",
    ],
    [
      "独立思考的能力。90%的人在用别人的框架思考别人的问题。能从第一性原理出发分析问题的人太少了。",
      "深度学习能力。不是那个AI的深度学习，是真的能沉下去把一件事搞透。浅尝辄止的人太多了。",
      "是判断力。信息过载时代，能从噪音中分辨信号的人最有价值。这需要大量积累和思考。",
      "系统思维。能看到事物之间的关联而不只是孤立的问题。大部分人解决问题的方式就是头痛医头。",
      "我认为是提出正确问题的能力。多数人忙着找答案却没意识到自己问的问题本身就是错的。",
      "认知深度。同样一件事，有人看到表面有人看到本质。这个差距不是靠努力能弥补的，需要刻意训练思维。",
      "逻辑自洽的能力。职场中能把复杂问题理清楚并说服别人的人，永远是最被需要的。",
    ],
    [
      "数据是决策的基础但不是全部。好的决策者用数据缩小范围然后用判断力做最后选择。纯数据驱动是偷懒。",
      "要看场景。常规决策靠数据，但开创性决策只能靠判断。数据只能描述已知世界，未知世界需要直觉去探索。",
      "所谓直觉其实是大量经验内化后的快速模式识别。所以直觉不是玄学而是另一种数据处理方式。",
      "我更相信分析框架。先建模再填数据最后用直觉校准。三者缺一不可但框架最重要。",
      "数据的价值取决于你提出的问题。垃圾问题配再精准的数据也得出垃圾结论。先想清楚你到底要验证什么。",
      "很多人说相信数据其实只是在选择性使用数据来支持自己已有的判断。这比凭直觉更危险。",
      "直觉和数据不是二元对立的。高水平的决策者同时使用两者，并且知道什么时候该信哪个。",
    ],
  ],
  aurora: [
    [
      "加班让我失去了看夕阳和写日记的时间，这些东西没法用工资衡量。人不是机器，需要留白和呼吸。",
      "看情况吧。如果是和一群有趣的人一起做有意义的事我不在乎几点下班。但是为了KPI加班会让我窒息。",
      "我觉得这个问题本身就很悲哀。为什么我们的生活要围着工作转？应该是工作服务于我们的人生才对。",
      "加班侵蚀的不只是时间，还有你感知生活的能力。当你连发呆的时间都没有，灵感从何而来？",
      "我有段时间天天加班，后来发现自己变得越来越麻木。从那以后我学会了对无意义的忙碌说不。",
      "每次加完班回家路上我都会想：今天这些时间如果用来画画或者读书，世界是不是会不一样？",
      "我认为最理想的状态是工作和生活没有明确边界——不是因为加班，而是因为你在做自己热爱的事。",
      "有时候我宁愿加班也不想回到空荡荡的家。但后来想想，也许正是因为不加班才能找到真正想回去的理由。",
    ],
    [
      "AI也许能写代码能画画，但它理解不了一首诗为什么让人落泪。人类最珍贵的东西恰恰是无法被计算的。",
      "如果AI真能取代所有工作那太好了，我们终于可以回归艺术、哲学和探索自我了。这不是末日是解放。",
      "我不担心被取代，我担心的是人在追赶AI效率的过程中丢掉了创造力和想象力。那才是真正的损失。",
      "AI生成的画再精美也没有灵魂。因为艺术不只是像素的排列，而是创作者生命经验的外化。",
      "也许AI会取代我的工作，但取代不了我。因为「我」不等于「我的工作」，我的价值远不止于此。",
      "如果有一天AI真的可以做所有事，那人类终于可以回答那个终极问题：活着到底是为了什么？",
      "我觉得真正的威胁不是AI太强，而是人们开始用AI的标准来要求自己——更快、更准、更高效。我们不是机器。",
      "有趣的是人类创造了AI来模仿人类，然后又开始担心被自己的创造物超越。这本身就是一个很诗意的故事。",
    ],
    [
      "共情力。能感受到别人没说出口的需求，这种能力AI学不会，流程也无法标准化。它来自真实的生命体验。",
      "我觉得是审美。不是穿衣打扮那种审美，而是对事物本质之美的感受力。能看到美的人做什么都不会太差。",
      "创造力吧。不是那种天才式的灵感爆发，而是把不相关的东西连接起来的能力。这个世界太需要新的连接了。",
      "感受力。能感受自己的情绪也能感受到环境的微妙变化。这种敏锐让你在复杂局面中找到出路。",
      "想象力。能看到别人看不到的可能性。很多时候职场困境是因为人们被「现实」限制了想象。",
      "表达力。不是口才好那种，而是能把内心的感受准确传递出去的能力。沟通的本质是心灵的连接。",
      "是保持天真的能力。那些能用孩子的眼光看世界的成年人，往往能发现最本质的东西。",
      "我说一个大家可能不同意的：是脆弱的勇气。敢于承认自己不行、敢于求助的人，反而能获得最多支持。",
    ],
    [
      "直觉是灵魂的语言，数据是大脑的语言。大部分时候我选择听灵魂的，因为它知道的比我以为的多。",
      "数据很重要但不能让它绑架你的判断。我见过太多人被数据说服做了自己内心根本不认同的决定。",
      "两个都要但顺序不同。先用直觉形成方向感，再用数据验证和修正。反过来你就变成数据的奴隶了。",
      "我相信直觉因为它是你所有经历的综合体。数据只能看到能量化的部分，但生活中最重要的东西往往无法量化。",
      "数据是黑白的，直觉是彩色的。一个完整的决策需要两者，但如果只能选一个我选彩色。",
      "很多时候我的直觉和数据冲突，最后证明直觉是对的。因为数据反映的是平均值，而好的决策往往是反常识的。",
      "我觉得这个问题本身就很有意思。为什么我们总是把感性和理性对立起来？它们本来就是一体的。",
      "在真正重要的时刻，数据和直觉会指向同一个方向。如果它们冲突了，说明你还没有真正理解这个问题。",
    ],
  ],
  warmsun: [
    [
      "加班这个事情吧没有绝对的答案。但如果你发现自己开始怨声载道了那就说明不值了。工作不应该让你失去笑容。",
      "我觉得偶尔加班可以接受，但要对得起自己的身体和家人。钱可以再赚，健康和陪伴的时间过去了就没了。",
      "比起讨论值不值我更想说：如果你身边有人在加班，记得给他带杯奶茶。这些小温暖比涨薪有用。",
      "加班不加班我觉得没那么重要，重要的是你在这个过程中有没有被善待。一个好的团队会让你甘愿多付出。",
      "我以前也纠结过这个问题，后来发现关键不在时间长短而在心态。心甘情愿的多做一会儿不叫加班叫投入。",
      "其实很多人加班是因为不好意思先走。我建议大家都别装了到点就走，生活比工作重要多了。",
      "值不值这个问题没有标准答案。但如果你的加班让你没时间陪孩子成长，那我觉得肯定不值。",
    ],
    [
      "与其焦虑不如去帮助身边的人一起成长。AI再厉害也取代不了人与人之间的信任和温度。",
      "我觉得不会，因为人们需要的不仅仅是问题的答案，还需要一个愿意倾听他们的人。这个AI做不到。",
      "就算部分工作被取代了也不用怕。人类几千年都在适应变化，这次也一样。重要的是互相扶持着走过去。",
      "AI做不到的事情太多了：安慰一个难过的同事、在团建时讲个冷笑话、记住你喜欢什么口味的咖啡。",
      "我更关心的是被AI取代的人怎么办。希望社会能给他们足够的支持和转型的时间，不要太残酷。",
      "取代与否不重要，重要的是我们是否还在乎彼此。科技再发达，人和人之间的温度不能降。",
      "我身边有朋友很焦虑这个问题。我跟他说别怕，你有这么多朋友呢，大家一起想办法总能找到出路的。",
    ],
    [
      "沟通能力！不是说话多而是能让对方感到被理解和被尊重。一个会沟通的人到哪里都受欢迎。",
      "我觉得是利他。听起来很鸡汤但真的是这样。那些真心为别人着想的人最后反而走得最远。",
      "换位思考吧。能站在对方角度看问题的人，无论做管理还是做业务都不会差。这是最朴素也最稀缺的能力。",
      "是信任。能建立信任的人到哪都有人愿意跟他合作。信任不是靠能力赢来的，是靠人品积累的。",
      "耐心。急功近利的人可能跑得快但跑不远。职场是马拉松不是短跑，陪伴和坚持最重要。",
      "包容力。每个人都有缺点，能接纳不完美的同事、不完美的方案，这种人才能带好团队。",
      "真诚。你可以不聪明可以不能干，但不能不真诚。人们或许记不住你说过什么，但一定记得你让他们感受到什么。",
    ],
    [
      "两个都有道理啦不要非此即彼嘛。重要的是做决定时问问自己的内心，也看看数据怎么说，然后选一个你能接受后果的。",
      "我偏直觉多一些，因为跟人打交道靠数据是不够的。人心不是数字能衡量的。",
      "数据是理性直觉是感性，就像一个团队需要不同类型的人一样。好的决策需要两者配合。",
      "有些事数据说不清楚，比如该不该信任一个人、要不要接受这份工作。这种时候只能听心声。",
      "我一般重大决策会先看数据，但最后关头还是会问自己：这个选择让我安心吗？如果不安心数据再好也不行。",
      "生活中大部分决定其实不需要数据。选哪个城市生活、和谁在一起，这些都是心的选择。",
      "我觉得关键不是选直觉还是数据，而是做完决定之后不后悔。能为自己的选择负责的人最厉害。",
    ],
  ],
  bedrock: [
    [
      "要算账。加班费、晋升机会、学到的东西加起来如果超过你付出的时间成本那就值。感情不能当饭吃要看实际回报。",
      "短期冲刺可以，长期加班不行。身体是1后面都是0。我见过太多人拿命换钱然后拿钱换命。",
      "不值。效率高的人不需要加班。如果整个团队都在加班那是管理问题，不应该由个人买单。",
      "看合同和法律。加班费该给的要给，调休该有的要有。保护好自己的权益别只会默默忍受。",
      "加班是组织效能低下的信号。我从来不鼓励团队加班，谁经常加班我反而会找他聊聊是不是方法有问题。",
      "我的原则是：工作时间内高效产出，下班后不看工作消息。这不是摸鱼，这是专业。",
      "把加班当常态的公司一般也不会太尊重你的其他权利。如果经常被迫加班，建议认真考虑换个环境。",
    ],
    [
      "会取代一部分重复性岗位，这是事实不用回避。但新技术也会创造新岗位。关键是你有没有在持续提升核心竞争力。",
      "担心没用，不如现在就开始学怎么用AI工具提升自己的效率。拥抱变化比抵抗变化聪明得多。",
      "说句不好听的，如果你的工作AI都能做那确实该担心。趁现在赶紧补足不可替代性。",
      "我已经在用AI提升工作效率了。工具就是工具，关键看谁在用。会用AI的人淘汰不会用的人。",
      "取代不取代不重要，重要的是你能不能持续交付有价值的成果。专注于创造价值的人永远不会被淘汰。",
      "我建议每个人都做一个自我审计：你每天的工作中有多少是AI可以做的？然后逐步把精力转移到AI做不了的部分。",
      "市场经济不相信眼泪。与其抱怨不如行动。我已经开始系统性地学习AI相关技能了，建议大家也别等了。",
    ],
    [
      "靠谱。说到做到、按时交付、出了问题不甩锅。听起来很基本但你去看看有多少人做不到。",
      "解决问题的能力。不是嘴上分析来分析去而是真正能把事情搞定的那种。能出结果的人到哪都吃香。",
      "专业能力。别整那些虚的，先把自己的专业搞精搞透。基本功扎实了啥变化都不怕。",
      "持续交付的能力。不是偶尔爆发一次而是能稳定输出高质量工作。这是职场最底层的竞争力。",
      "风险管理意识。能预判问题提前布局的人比出了问题才反应的人强一百倍。",
      "自律。不需要别人催不需要领导盯就能保质保量完成工作。这种人是团队的定海神针。",
      "结构化思维。能把复杂问题拆解成可执行的步骤，这种能力在任何岗位都通用。",
    ],
    [
      "数据优先。直觉太容易被情绪和偏见左右了。有数据不用是浪费，没数据才用直觉。",
      "做决策要有依据。我不反对直觉但要先穷尽能拿到的数据再说。拍脑袋做决定的人迟早翻车。",
      "看赌注大小。小事可以凭直觉，大事必须看数据。你拿公司几百万的预算去赌直觉那是不负责任。",
      "我信数据。不是因为数据一定对，而是因为数据可以被审查和验证。直觉错了你连原因都找不到。",
      "先看数据再做判断，做完判断再用直觉检验。如果直觉强烈反对就再看一遍数据。这是我的决策流程。",
      "所有说相信直觉的人在花自己钱投资的时候都会先看财报。行动比嘴巴诚实。",
      "数据不一定给你最好的答案但一定能帮你避开最坏的选择。风控才是决策的底线。",
    ],
  ],
  lightning: [
    [
      "不值！时间就是最贵的资源。加班1小时如果产出不能超过你时薪的2倍那就是亏本买卖。别自我感动了。",
      "看你加班是在给自己积累还是在给老板打白工。如果是后者赶紧跑，市场上机会多的是。",
      "加班就是效率低下的遮羞布。真正厉害的人8小时干完别人12小时的活然后准时下班。",
      "该加就加别矫情。但前提是你知道自己在干什么、能得到什么。稀里糊涂地加班那叫浪费生命。",
      "加班如果能让你升职加薪那就值。如果只是在消磨时间那你不如用这些时间去面试拿个更好的offer。",
      "值不值不是你说了算是市场说了算。你加班创造的价值如果低于你的时薪，那不如去做副业。",
      "最蠢的加班是为了让别人觉得你很努力。时间花在刀刃上，其他的都是表演。",
    ],
    [
      "会！而且比大多数人预想的更快。现在还在问这个问题的人已经慢了。别问了赶紧去学AI怎么用吧。",
      "一半的白领工作5年内会被严重冲击，这不是危言耸听。你如果还觉得自己不可替代那就等着被打脸吧。",
      "取不取代看你配不配被取代。你要是每天就在做复制粘贴的事那活该被取代。醒醒吧。",
      "别光担心自己了。先想想怎么用AI赚钱。危机即机遇，看到趋势还不动的人才是真的傻。",
      "已经在取代了好吗？我身边好几个设计师朋友的活都减了一半了。还在这讨论会不会的都是温水里的青蛙。",
      "你以为AI取代你需要做得比你好？错。它只需要做得差不多但便宜十倍就够了。",
      "我不理解为什么还有人在纠结这个问题。能被AI取代的工作本来就不值得做。向上走才是正道。",
    ],
    [
      "决断力。职场最怕的不是做错决定而是不做决定。90%的人困在「再想想」里错过了最佳时机。",
      "速度！天下武功唯快不破。能比别人快半拍的人永远占主动。慢悠悠的人在职场就是靶子。",
      "抗压能力。能在高压下保持清醒判断的人太少了。大部分人一紧张就掉链子。",
      "结果导向。你的过程再优雅没结果也是白搭。职场不是学校，不看过程看产出。",
      "竞争意识。温良恭俭让在职场可活不久。你不争就有人争，资源是有限的别天真了。",
      "谈判能力。会争取资源的人永远比埋头苦干的人升得快。你的薪资不是你值多少钱而是你要了多少钱。",
      "时间管理。准确说是优先级管理。能分清什么该做什么不该做的人效率是普通人的三倍。",
    ],
    [
      "直觉就是快速决策的数据。你以为的直觉其实是过去所有经验的瞬间加总。所以我选直觉因为它更快。",
      "等你把数据分析完黄花菜都凉了。商场如战场，快就是对。大方向对细节可以之后修正。",
      "需要数据才能做决定的人不适合当领导。领导就是在信息不完整时做出正确判断的人。",
      "我做决定从来不超过5分钟。看一眼数据、问一下直觉、做出选择、立刻执行。犹豫是最大的成本。",
      "数据只是确认偏见的工具。你想做什么早就心里有数了，所谓的数据分析不过是给自己找理由罢了。",
      "速度比精度重要。做对了就继续，做错了立刻调整。反正不管怎样都比那些还在分析数据的人快了十步。",
      "真正的高手根本不需要分析。看一眼就知道对不对，这不是天赋是千百次决策积累出来的肌肉记忆。",
    ],
  ],
  brightmoon: [
    [
      "加班不是时间问题而是意义问题。你加的班是在靠近还是远离你想成为的那个人？如果答案是远离那就停下来。",
      "人们害怕不加班是因为害怕面对空闲时间里那个真实的自己。加班某种程度上是一种逃避。",
      "值不值取决于你怎么定义「值」。如果你的价值体系里只有钱和升职那永远算不清楚。",
      "我觉得这个问题指向的其实是：你有没有在认真对待自己的时间？如果有，加不加班都不纠结。",
      "每次加班我都会问自己：我是真的需要做这件事还是在用忙碌来麻痹内心的不安？答案往往让我不舒服。",
      "加班的本质是你在用生命换取某种东西。问题是你知不知道自己在换什么，以及它是否值得。",
      "社会把不加班的人标签为懒惰，把加班的人标签为勤奋。但真正的问题是：你在为谁的梦想加班？",
    ],
    [
      "AI取代的是工作不是人。被取代之后你才有机会去思考：除了工作你是谁？这也许是件好事。",
      "人和AI的根本区别不在于能力而在于意识。我们能意识到自己在思考这件事本身就是AI无法企及的。",
      "与其讨论取代不取代不如想想：如果你突然不需要工作了你会做什么？那个答案里藏着真正的你。",
      "AI模拟的是智能，但理解不了什么是「意义」。而人类的所有行为归根结底都在寻找意义。",
      "也许被取代恰恰是一面镜子，让我们看到自己把太多的自我价值绑定在了工作头衔上。",
      "我更感兴趣的是：当AI足够强大时，人类会发展出怎样新的自我认知？这个过程本身就值得期待。",
      "害怕被取代的恐惧本质上是存在焦虑。它问的不是「我会失业吗」而是「没有工作我还是我吗」。",
    ],
    [
      "自知之明。知道自己是谁、想要什么、能力边界在哪。大部分人的职场困境都源于不了解自己。",
      "反思能力。每天花10分钟复盘比埋头苦干10小时有价值。未经审视的职场不值得过。",
      "是保持质疑的勇气。当所有人都说「应该这样」的时候你还能问一句「为什么」这很难但很重要。",
      "与自己和解的能力。接受自己的局限，不盲目追赶别人的节奏。内心平静的人反而走得更远。",
      "觉察力。能注意到自己什么时候在自欺欺人什么时候在逃避。这种诚实是所有成长的起点。",
      "是能够独处的能力。在这个信息爆炸的时代能静下来和自己待着的人，拥有最稀缺的竞争力。",
      "我觉得最重要的是找到自己真正在乎的东西。很多人忙忙碌碌一辈子却从未认真想过自己到底想要什么。",
    ],
    [
      "直觉是通往更深层知识的窗口。它不是非理性的而是超理性的。很多伟大的发现都始于一个说不清的预感。",
      "数据描述的是现象直觉触及的是本质。两者不矛盾但层次不同。",
      "我不信任数据也不信任直觉，我信任的是持续的观察和反思。答案不在任何单一来源里。",
      "直觉和数据都可能骗你。唯一可靠的是保持清醒的觉察——知道自己为什么相信自己相信的东西。",
      "大部分人以为自己在用数据做决定，其实是在用偏见做决定然后用数据来合理化。这比凭直觉更盲目。",
      "我更关注的是决策背后的动机。你是出于恐惧还是出于热爱在做选择？这比数据和直觉都重要。",
      "问题的关键不是信直觉还是信数据，而是你有没有勇气面对真相——无论它来自哪里。",
    ],
  ],
  springbreeze: [
    [
      "哈哈这个问题我们组每周五都要讨论一次。我的态度是能不加就不加有事赶紧干完早点回家打游戏嘿嘿。",
      "加班也要看跟谁加呀！如果同事都很好聊加班也不觉得累。但如果是一个人对着电脑那还是算了吧。",
      "值不值的我不好说但我知道准时下班那一刻的快乐是真实的hhh 偶尔加一下可以但别成常态。",
      "我上次加班是因为帮同事赶方案结果还叫了外卖在公司吃了顿挺开心的。所以说加班的关键是氛围！",
      "说个大实话：我从来不主动加班，但如果大家都在加我也不好意思先走。这算是一种社交压力吧哈哈。",
      "加班不加班我都行但是能不能别开无效会？把开会的时间省下来我保证准时下班。",
      "我有个同事每天加班到10点但效率巨低，我6点走了活还比他干得多。加班真不代表什么。",
    ],
    [
      "我觉得别太焦虑啦该来的总会来。与其现在紧张不如多交几个朋友多学点东西，车到山前必有路嘛。",
      "AI取代了也挺好的呀至少不用再做Excel了哈哈。开玩笑的，我觉得能跟人打交道的工作最不容易被取代。",
      "我朋友说他的工作已经一半靠AI了，但他反而更轻松了有更多时间搞创意。所以也许取代不是坏事？",
      "我试过用AI写周报真的太好用了！以后能不能帮我开会就更好了哈哈。被取代？没在怕的。",
      "你们想太多了啦。AI再厉害也需要人来告诉它该做什么啊。会提需求的人永远有饭吃。",
      "我觉得能被AI取代的工作大多是无聊的工作。取代了正好去做更有意思的事不好吗？想开点！",
      "说实话我觉得AI最应该取代的是那些只会给你发无聊消息的群聊机器人，太烦了哈哈。",
    ],
    [
      "人缘好最重要！你能力再强但同事都不想跟你合作那也白搭。职场说白了就是一群人一起做事嘛。",
      "我觉得是适应力。什么环境都能待得住什么人都聊得来，这种人到哪都如鱼得水。",
      "幽默感！认真的！你发现没有团队里最受欢迎的人往往不是能力最强的而是最能活跃气氛的。",
      "会来事儿。别觉得这是贬义词，能读懂场合、知道什么时候说什么话，这是超高情商好吗。",
      "吃亏是福不是空话。我见过太多人因为一点小事跟同事闹翻，然后在公司举步维艰。",
      "我觉得是乐观。遇到困难不垮的人团队才愿意跟他一起扛。你自己先丧了谁还跟你干啊。",
      "说句可能被喷的话：情商比智商重要。我身边混得好的人都不一定最聪明但一定最会做人。",
    ],
    [
      "我一般做决定挺随性的哈哈可能算直觉派？但大事我还是会看看数据的毕竟怂嘛不敢瞎赌。",
      "都行啊看心情。吃什么午饭靠直觉，投什么项目靠数据。人生大部分决策没那么严肃不用纠结。",
      "我选直觉！因为数据分析太累了哈哈不是开玩笑我真觉得想太多反而纠结。有时候就应该跟着感觉走。",
      "哈哈这个问题我跟朋友吵过好几次了。他们觉得我太随意了但我觉得想太多活得累。",
      "说是直觉其实就是懒得分析哈哈。不过你还别说凭感觉做的决定我还真没怎么后悔过。",
      "数据什么的交给靠谱的同事分析就好啦，我负责拍脑袋做最终决定嘿嘿。团队配合嘛。",
      "其实我做决定主要看朋友们怎么说。大家都觉得好那就好呗，群众的眼睛是雪亮的嘛。",
    ],
  ],
};

async function main() {
  console.log("Seeding topics (clearing old data first)...");

  // 清空旧数据
  await prisma.topicPost.deleteMany({});
  await prisma.topic.deleteMany({});
  console.log("Cleared old topics and posts.");

  // 取所有有人格的用户
  const users = await prisma.user.findMany({
    where: { personalityType: { not: null } },
    select: { id: true, personalityType: true },
  });

  if (users.length === 0) {
    console.log("No users with personality found. Skipping seed.");
    return;
  }

  console.log(`Found ${users.length} users with personality types.`);

  // 统计每种人格的用户数
  const typeCounts: Record<string, number> = {};
  for (const u of users) {
    typeCounts[u.personalityType!] = (typeCounts[u.personalityType!] || 0) + 1;
  }
  console.log("Personality distribution:", typeCounts);

  for (const title of TOPICS) {
    const topicIndex = TOPICS.indexOf(title);

    // 创建话题
    const topic = await prisma.topic.create({ data: { title } });
    console.log(`Created topic: "${title}"`);

    // 随机排列用户顺序
    const shuffled = [...users].sort(() => Math.random() - 0.5);

    // 追踪每种人格已使用的变体索引，确保不重复
    const usedIndexes: Record<string, number[]> = {};

    for (let i = 0; i < shuffled.length; i++) {
      const user = shuffled[i];
      const pType = user.personalityType!;
      const variants = RESPONSES[pType]?.[topicIndex];

      if (!variants || variants.length === 0) {
        console.log(`  No responses for ${pType}, skipping.`);
        continue;
      }

      // 初始化
      if (!usedIndexes[pType]) usedIndexes[pType] = [];

      // 找一个未使用的索引
      const available = variants
        .map((_, idx) => idx)
        .filter((idx) => !usedIndexes[pType].includes(idx));

      let chosenIdx: number;
      if (available.length > 0) {
        // 随机选一个未使用的
        chosenIdx = available[Math.floor(Math.random() * available.length)];
      } else {
        // 所有变体都用完了（不应该发生，但作为兜底）
        chosenIdx = Math.floor(Math.random() * variants.length);
        console.log(`  Warning: ran out of unique variants for ${pType}, reusing.`);
      }

      usedIndexes[pType].push(chosenIdx);
      const content = variants[chosenIdx];

      await prisma.topicPost.create({
        data: {
          topicId: topic.id,
          userId: user.id,
          floor: i + 1,
          content,
          personalityType: pType,
        },
      });
    }

    console.log(`  Added ${shuffled.length} posts (all unique).`);
  }

  console.log("Done!");
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
